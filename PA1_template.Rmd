# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data
Loading required libraries
```{r, echo = TRUE}
#install.packages("ggplot2")
library(ggplot2)
```
Downloading data
```{r, echo = TRUE}
setwd("d:/DEV/R/Learning")
#fileUrl="https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
fileURL="https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
if(!file.exists("gettingData")){
  dir.create("gettingData")
}
setwd("d:/DEV/R/Learning/gettingData")
download.file(fileUrl, destfile = "activity.zip", method="auto")
list.files(".//gettingData")
activityDateDownloaded = date()
```

Loading activities data and changing  the date into a format suitable for our analysis:
```{r preparation, echo = TRUE}
activities=read.csv(unz(description ="activity.zip", "activity.csv"), sep=",")
str(activities)
activities$date = as.Date(activities$date, format="%Y-%m-%d")
activities$fdate = factor(activities$date)
activities$finterval = factor(activities$interval)
```



## What is mean total number of steps taken per day?
```{r, echo = TRUE}
sumData=tapply(activities$steps, activities$fdate,sum, na.rm=TRUE)
png(filename=".//figure/Total_number_of_steps_per_day_(Histogram).png", width = 480, height = 480, units = "px", pointsize = 12, bg = "white", res = NA, family = "", restoreConsole = TRUE)
sum = data.frame(dimnames(sumData),sumData)
names(sum)=c("Date", "Steps")
hist(sumData)

dev.off()
png(filename=".//figure/Total_number_of_steps_per_day.png", width = 480, height = 480, units = "px", pointsize = 12, bg = "white", res = NA, family = "", restoreConsole = TRUE)
a = ggplot(data = sum, aes(x=as.Date(Date), y=Steps), ordered=TRUE) + geom_line() + geom_point()+
  labs(x = "Month", y = " Total Number of Steps Taken Each Day")
a

dev.off()

mean(sumData, na.rm = TRUE)
median(sumData, na.rm = TRUE)
```


## What is the average daily activity pattern?
```{r, echo = TRUE}

#avgData=tapply(activities$steps, factor(activities$interval),mean, na.rm=TRUE)
avgData=tapply(activities$steps, activities$interval,mean, na.rm=TRUE)
avg = data.frame(dimnames(avgData),avgData)
names(avg)=c("Interval", "Activities")
png(filename=".//figure/Average_Daily_Activity_Pattern.png", width = 480, height = 480, units = "px", pointsize = 12, bg = "white", res = NA, family = "", restoreConsole = TRUE)
#ggplot2(activities$fdate, sumData, type="l")

#qplot(avg$Interval, avg$Activities, geom = "path")
#plot(avg$Interval, avg$Activities, type = "l")
theme(axis.text.x = element_text(angle = 90, hjust = 0))
ggplot(data= avg, aes(x = order(Interval), y = Activities), ordered=TRUE) + geom_line() + geom_point(colour = 'red', size = 3)+
  xlab("Interval") +
  ylab("Average number of steps taken, averaged across all days") +
  ggtitle("Average Daily Activity Pattern")
  
dev.off()
intervalOfMaxAverageStepsNo_Index = which.max(avg$Activities)
intervalOfMaxAverageStepsNo_Value = max(avg$Activities)
```


## Imputing missing values
```{r, echo = TRUE}

```


## Are there differences in activity patterns between weekdays and weekends?
```{r, echo = TRUE}

```